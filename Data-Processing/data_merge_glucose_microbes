import pandas as pd

# === Load Data ===
DATA_PATH = "../Data-Processing/Dataset/filtered_merged_alldata.csv"
df = pd.read_csv(DATA_PATH)

# === Identify Microbiome Columns ===
# These columns are between "clinical_HOMA_IR" and "meal_category"
start_idx = df.columns.get_loc("clinical_HOMA_IR") + 1
end_idx   = df.columns.get_loc("meal_category")
microbiome_cols = df.columns[start_idx:end_idx]

# === Select Relevant Columns ===
selected_cols = list(microbiome_cols) + ["glucose_spike_30min", "glucose_spike_60min"]
merged_df = df[selected_cols]

# === Save Output ===
OUTPUT_PATH = "Dataset/filtered_microbiome_glucose.csv"
merged_df.to_csv(OUTPUT_PATH, index=False)
print(f"Saved to: {OUTPUT_PATH}")
